# 21 - Search engines and indexing systems Elasticsearch Solr

## 1. Activate Prior Knowledge

- Какви са основните предизвикателства при търсенето на информация в големи обеми от текстови данни?
- Какви подходи познавате за бързо намиране на релевантна информация в база данни или документи?
- Как мислите, че системи като Google намират и подреждат резултатите при търсене?

## 2. Overview

Search engines and indexing systems като Elasticsearch и Solr са ключови технологии за ефективно търсене и анализ на големи обеми от неструктурирани или слабо структурирани данни. Те позволяват на потребителите и приложенията да намират релевантна информация мигновено, дори когато работят с милиони документи или записи.

Тези системи използват специализирани структури от данни и алгоритми за индексиране, които правят възможно бързото търсене по ключови думи, фрази, филтри и дори по сложни заявки. В контекста на съвременните AI системи и софтуерно инженерство, те често са гръбнакът на функционалности като интелигентно търсене, препоръчване на съдържание и анализ на текст.

Elasticsearch и Solr са най-популярните open-source решения в тази област. Те се използват в големи компании и платформи (например Wikipedia, GitHub, Netflix) заради тяхната мащабируемост, гъвкавост и богати възможности за интеграция.

## 3. Key Concepts

- **Index (Индекс)** – Структура от данни, която позволява бързо търсене в големи масиви от документи. Може да се сравни с азбучен указател в книга.
- **Document (Документ)** – Основна единица за съхранение на информация, обикновено във формат JSON или XML.
- **Field (Поле)** – Атрибут или ключ в документа, например “title”, “author”, “date”.
- **Full-text search (Пълнотекстово търсене)** – Търсене, което анализира и сравнява цели текстове, а не само точни съвпадения.
- **Analyzer (Анализатор)** – Компонент, който обработва текста (например разделя на думи, премахва стоп-думи), за да подобри търсенето.
- **Query (Заявка)** – Описание на това какво искаме да намерим; може да бъде проста или сложна (например с булеви оператори).
- **Cluster (Клъстер)** – Група от сървъри, които работят заедно, за да осигурят мащабируемост и надеждност.
- **Shard (Шард)** – Част от индекса, която може да се съхранява и обработва независимо, за по-добра производителност.

## 4. Step-by-step Learning Path

1. **Разберете основите на индексирането**
   - Фокус: Какво е индекс, как се създава и използва.
   - Практическа задача: Създайте прост индекс в Elasticsearch или Solr с няколко документа.
   - Въпроси: Какво представлява индексът? Защо е по-бърз от обикновено търсене?

2. **Изучете структурата на документите и полетата**
   - Фокус: Как се моделират данните в документи и полета.
   - Практическа задача: Добавете ново поле към съществуващ документ и го преиндексирайте.
   - Въпроси: Какво е поле? Как добавянето на ново поле влияе на индекса?

3. **Експериментирайте с пълнотекстово търсене**
   - Фокус: Как работи анализаторът и как се обработва текстът.
   - Практическа задача: Направете търсене по ключова дума и по фраза, сравнете резултатите.
   - Въпроси: Какво е анализатор? Какво е разликата между търсене по дума и по фраза?

4. **Работете със заявки и филтри**
   - Фокус: Създаване на сложни заявки с булеви оператори и филтри.
   - Практическа задача: Изпълнете заявка, която комбинира няколко условия (AND, OR, NOT).
   - Въпроси: Как се комбинират условия в заявка? Какво е филтър?

5. **Мащабиране и оптимизация**
   - Фокус: Как се използват клъстери и шардове за по-добра производителност.
   - Практическа задача: Добавете нов шард или реплика към клъстер.
   - Въпроси: Какво е шард? Какво е клъстер? Защо са важни?

## 5. Examples

### Пример 1: Индексиране и търсене в Elasticsearch

```json
PUT /library/books/1
{
  "title": "Война и мир",
  "author": "Лев Толстой",
  "year": 1869
}

GET /library/books/_search
{
  "query": {
    "match": {
      "title": "война"
    }
  }
}
```

### Пример 2: Сложна заявка в Solr

```xml
http://localhost:8983/solr/books/select?q=author:"Толстой" AND year:[1800 TO 1900]
```

### Пример 3: Добавяне на ново поле

```json
PUT /library/books/2
{
  "title": "Под игото",
  "author": "Иван Вазов",
  "year": 1894,
  "genre": "Роман"
}
```

## 6. Common Pitfalls

- **Пренебрегване на анализа на текста** – Ако не се използва подходящ анализатор, търсенето може да пропусне релевантни резултати.
- **Неправилно моделиране на документи** – Липсата на добре структурирани полета затруднява търсенето и филтрирането.
- **Недостатъчно шардове или реплики** – Може да доведе до ниска производителност или загуба на данни при срив.
- **Сложни заявки без оптимизация** – Могат да натоварят системата и да забавят отговорите.

## 7. Short Retrieval Quiz

1. Какво е индекс и защо е важен?
2. Каква е разликата между документ и поле?
3. Какво прави анализаторът в search engine?
4. Какво е пълнотекстово търсене?
5. Какво е шард и как помага за производителността?
6. Как се комбинират условия в заявка?
7. Какво е клъстер и защо се използва?

## 8. Quick Recap

- Search engines като Elasticsearch и Solr позволяват бързо и ефективно търсене в големи масиви от данни.
- Индексирането е ключово за бързото намиране на информация.
- Документите съдържат полета, които структурират данните.
- Анализаторите обработват текста, за да подобрят резултатите от търсенето.
- Клъстерите и шардовете осигуряват мащабируемост и надеждност.
- Заявките могат да бъдат прости или сложни, с множество условия и филтри.
- Правилното моделиране и оптимизация са критични за добрата работа на системата.

## 9. Spaced Review Plan

| Review Time | Prompt                                                      |
|-------------|-------------------------------------------------------------|
| 1 day       | Обяснете с примери какво е индекс и как работи анализаторът.|
| 3 days      | Избройте основните разлики между Elasticsearch и Solr.      |
| 1 week      | Създайте примерна заявка с няколко условия и обяснете резултата.|
| 1 month     | Опишете как бихте мащабирали search engine система за милиони документи. |