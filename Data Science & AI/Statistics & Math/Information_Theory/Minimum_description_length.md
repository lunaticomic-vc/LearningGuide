# Minimum_description_length

## 1. Activate Prior Knowledge

- Какво означава компресия на данни и как тя може да бъде свързана с моделирането на данни?
- Как бихте обяснили баланса между сложността на модела и точността му при прогнозиране?
- В какви ситуации в изкуствения интелект или софтуерното инженерство бихте предпочели по-прост модел пред по-сложен?

## 2. Overview

Minimum Description Length (MDL) е принцип в теорията на информацията и статистиката, който предлага метод за избор на най-добрия модел за дадени данни чрез минимизиране на общата дължина на описанието на модела и на данните, кодирани с този модел. Идеята е, че най-добрият модел е този, който компресира данните най-ефективно, като същевременно не е прекалено сложен.

MDL се използва широко в машинното обучение, статистическото моделиране и изкуствения интелект за предотвратяване на пренасищане (overfitting). Той предоставя формален начин да се балансира между сложността на модела и неговата способност да обяснява наблюдаваните данни.

В по-широк контекст, MDL е част от информационната теория и свързан с концепции като ентропия и кодиране. Той е практичен инструмент за инженери и учени, които искат да изградят модели, които са едновременно ефективни и обобщаващи.

## 3. Key Concepts

- **Description Length** – Количеството информация (в битове или други мерни единици), необходимо за представяне на модел и данните, кодирани с него. Може да се мисли като „размера на файла“, описващ модела и данните.
- **Model Complexity** – Мярка за това колко сложно е едно описание на модела. По-сложните модели изискват повече битове за кодиране, подобно на това как по-сложен чертеж заема повече място.
- **Overfitting (Пренасищане)** – Случай, когато моделът е твърде сложен и започва да „запомня“ шума в данните, вместо да открива истинските закономерности.
- **Two-part Code** – Метод за кодиране, при който първо се кодира моделът, а след това данните, използвайки този модел. Аналогично на това да опишеш рецептата (модела) и след това да опишеш ястието (данните) според рецептата.
- **Kolmogorov Complexity** – Теоретична мярка за най-краткото описание на даден обект, която MDL се опитва да приближи на практика.

## 4. Step-by-step Learning Path

1. **Разберете основите на информационната теория и кодиране**
   - Фокус: Ентропия, кодиране на данни, битове като мярка за информация.
   - Задача: Програмирайте прост ентропиен кодер за текстови данни.
   - Въпроси: Какво е ентропия? Защо по-ниската ентропия означава по-добра компресия?

2. **Изучете концепцията за моделиране и пренасищане**
   - Фокус: Разлика между подгонване (underfitting), добро моделиране и пренасищане.
   - Задача: Обучете няколко модела с различна сложност върху един и същи набор от данни и сравнете резултатите.
   - Въпроси: Как пренасищането влияе на качеството на модела? Как да го разпознаете?

3. **Запознайте се с принципа Minimum Description Length**
   - Фокус: Дефиниция и формулировка на MDL, двучастично кодиране.
   - Задача: Изчислете описателната дължина на прост модел и данни, използвайки двучастично кодиране.
   - Въпроси: Какво означава да минимизираме описателната дължина? Как MDL помага при избора на модел?

4. **Приложете MDL в практическо машинно обучение**
   - Фокус: Използване на MDL за избор на хиперпараметри и модели.
   - Задача: Имплементирайте селекция на модел, базирана на MDL, върху регресионен или класификационен проблем.
   - Въпроси: Как MDL се различава от други критерии като AIC или BIC? Кога е по-подходящ?

5. **Анализирайте ограниченията и разширенията на MDL**
   - Фокус: Теоретични и практически ограничения, връзки с други методи.
   - Задача: Напишете кратък анализ на случаи, в които MDL не дава оптимални резултати.
   - Въпроси: Какви са основните предизвикателства при прилагането на MDL? Как могат да се преодолеят?

## 5. Examples

### Пример 1: Избор на полиномна регресия с MDL

Имаме набор от точки и искаме да изберем степента на полинома, който най-добре описва данните.

```python
import numpy as np
from sklearn.preprocessing import PolynomialFeatures
from sklearn.linear_model import LinearRegression

X = np.linspace(0, 1, 100).reshape(-1, 1)
y = np.sin(2 * np.pi * X).ravel() + np.random.normal(0, 0.1, 100)

def description_length(model, X, y):
    residuals = y - model.predict(X)
    error_bits = np.sum(-np.log2(np.exp(-residuals**2)))
    model_bits = len(model.coef_) * 32  # груба оценка: 32 бита на коефициент
    return error_bits + model_bits

best_dl = float('inf')
best_degree = 0
for degree in range(1, 6):
    poly = PolynomialFeatures(degree)
    X_poly = poly.fit_transform(X)
    model = LinearRegression().fit(X_poly, y)
    dl = description_length(model, X_poly, y)
    if dl < best_dl:
        best_dl = dl
        best_degree = degree

print(f"Най-добър полином по MDL: степен {best_degree}")
```

### Пример 2: Избор на модел в класификация с MDL

Използване на MDL за избор между различни модели на дървета за класификация.

```python
from sklearn.datasets import load_iris
from sklearn.tree import DecisionTreeClassifier
from sklearn.model_selection import train_test_split

data = load_iris()
X_train, X_test, y_train, y_test = train_test_split(data.data, data.target, random_state=42)

def mdl_score(tree, X, y):
    # Примерна оценка: дължина на дървото + грешки
    tree_size = tree.tree_.node_count
    errors = sum(tree.predict(X) != y)
    return tree_size * 10 + errors * 100  # тежести за илюстрация

best_score = float('inf')
best_depth = None
for depth in range(1, 10):
    clf = DecisionTreeClassifier(max_depth=depth).fit(X_train, y_train)
    score = mdl_score(clf, X_test, y_test)
    if score < best_score:
        best_score = score
        best_depth = depth

print(f"Оптимална дълбочина на дървото по MDL: {best_depth}")
```

## 6. Common Pitfalls

- **Игнориране на баланса между модел и данни** – Фокусиране само върху минимизиране на грешката без да се отчита сложността на модела води до пренасищане.
- **Грешно изчисляване на описателната дължина** – Недооценяване на кода за модела или на кода за грешките може да изкриви избора.
- **Прилагане на MDL без разбиране на контекста** – MDL не е универсален и трябва да се адаптира към спецификата на задачата и данните.
- **Пренебрегване на шум и аномалии в данните** – Те могат да увеличат описателната дължина и да повлияят на избора на модел.
- **Сравняване на модели с различни предположения без корекция** – MDL изисква коректно кодиране, което зависи от модела и данните.

## 7. Short Retrieval Quiz

1. Какво представлява принципът Minimum Description Length?
2. Защо е важно да се балансира сложността на модела и точността му?
3. Какво означава двучастично кодиране в контекста на MDL?
4. Как MDL помага да се избегне пренасищането?
5. Каква е ролята на ентропията в MDL?
6. Кои са основните компоненти на описателната дължина?
7. Какво може да се случи, ако се игнорира сложността на модела при избор?

## 8. Quick Recap

- MDL е принцип за избор на модел чрез минимизиране на общата дължина на описанието на модела и данните.
- Той балансира между сложността на модела и точността му, предотвратявайки пренасищане.
- Основният метод е двучастичното кодиране: първо описваме модела, после данните с него.
- MDL е приложим в машинно обучение, статистика и информационна теория.
- Правилното изчисляване на описателната дължина е ключово за успешното прилагане.
- MDL не е универсален и изисква адаптация към конкретния проблем.
- Използването на MDL подобрява обобщаващата способност на модели и намалява риска от грешки при прогнозиране.

## 9. Spaced Review Plan

| Време след учене | Промпт за преговор                                   |
|------------------|-----------------------------------------------------|
| 1 ден            | Обяснете с прости думи какво е Minimum Description Length. |
| 3 дни            | Дайте пример за двучастично кодиране и защо е важно.       |
| 1 седмица        | Опишете как MDL помага при избора на модел в машинното обучение. |
| 1 месец          | Анализирайте потенциални ограничения на MDL и как да ги преодолеете. |