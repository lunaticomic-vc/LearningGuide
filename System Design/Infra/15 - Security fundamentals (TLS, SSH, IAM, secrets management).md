# 15 - Security fundamentals (TLS, SSH, IAM, secrets management)

## 1. Activate Prior Knowledge

- Какви методи за удостоверяване и криптиране сте използвали или чували в предишни проекти или курсове?
- Кога за последно сте се сблъсквали с нуждата да управлявате достъп до чувствителна информация (например API ключове, пароли) в софтуерна система?
- Какви рискове бихте предвидили, ако комуникацията между два сървъра не е защитена?

## 2. Overview

Security fundamentals са критична част от всяка съвременна софтуерна система, особено когато се работи с чувствителни данни или се интегрират външни услуги. Теми като TLS (Transport Layer Security), SSH (Secure Shell), IAM (Identity and Access Management) и secrets management са основни инструменти за гарантиране на поверителност, целостта и достъпността на информацията.

TLS осигурява криптирана комуникация между клиенти и сървъри, като предпазва от подслушване и атаки тип "man-in-the-middle". SSH позволява сигурен достъп до отдалечени машини и често се използва за администриране на сървъри. IAM системите управляват кой има достъп до кои ресурси, а secrets management се грижи за защитеното съхранение и използване на чувствителни данни като пароли и API ключове.

В контекста на AI системи и облачни среди, тези механизми са още по-важни, тъй като често се работи с големи обеми от данни и множество интеграции. Разбирането и прилагането на security fundamentals е предпоставка за изграждане на надеждни и мащабируеми решения.

## 3. Key Concepts

- **TLS (Transport Layer Security)** – Протокол за криптиране на комуникацията между два компютъра. Представете си го като "запечатан плик" за вашите данни по интернет.
- **SSH (Secure Shell)** – Протокол за сигурен достъп и управление на отдалечени машини. Може да се сравни с "защитена линия" между вас и сървъра.
- **IAM (Identity and Access Management)** – Система за управление на потребителските идентичности и техните права за достъп. Мислете за IAM като за "портиера", който решава кой може да влезе и какво може да прави.
- **Secrets Management** – Процес и инструменти за сигурно съхранение, достъп и ротация на чувствителни данни. Аналогия: сейф, в който държите най-ценните си ключове.
- **Certificate Authority (CA)** – Доверена трета страна, която издава цифрови сертификати за потвърждение на идентичността.
- **Public/Private Key Pair** – Два свързани ключа: публичен (който споделяте) и частен (който пазите тайно), използвани за криптиране и удостоверяване.
- **Principle of Least Privilege** – Дайте на всеки потребител или процес само минималните права, необходими за изпълнение на задачите му.

## 4. Step-by-step Learning Path

1. **Запознайте се с TLS и сертификатите**
   - Фокус: Как работи TLS, какво е сертификат, как се осъществява handshake.
   - Практическа задача: Проверете TLS сертификата на любим уебсайт чрез браузъра си.
   - Retrieval questions:
     - Каква е ролята на Certificate Authority?
     - Какво се случва при TLS handshake?

2. **Използвайте SSH за сигурен достъп**
   - Фокус: Генериране на ключове, установяване на SSH връзка, основни команди.
   - Практическа задача: Генерирайте SSH ключ и се свържете с отдалечен Linux сървър (може да е виртуален).
   - Retrieval questions:
     - Каква е разликата между публичен и частен ключ?
     - Как се удостоверява потребителят при SSH?

3. **Разучете основите на IAM**
   - Фокус: Роли, политики, групи, принцип на най-малките права.
   - Практическа задача: Създайте IAM потребител и му задайте минимални права в AWS Free Tier.
   - Retrieval questions:
     - Какво е IAM роля?
     - Защо е важно да се прилага принципът на най-малките права?

4. **Внедрете secrets management**
   - Фокус: Инструменти (напр. HashiCorp Vault, AWS Secrets Manager), добри практики.
   - Практическа задача: Съхранете и извлечете секрет (например API ключ) чрез избран инструмент.
   - Retrieval questions:
     - Какви са рисковете при съхранение на пароли в код?
     - Какви са предимствата на централизираното управление на секрети?

## 5. Examples

### Пример 1: Проверка на TLS сертификат

```bash
openssl s_client -connect google.com:443
```
Изходът показва информация за сертификата, включително издател, валидност и публичен ключ.

### Пример 2: Генериране на SSH ключ и свързване

```bash
ssh-keygen -t ed25519 -C "your_email@example.com"
ssh user@remote-server
```
Това създава ключова двойка и установява сигурна връзка със сървъра.

### Пример 3: Използване на secrets management инструмент (AWS Secrets Manager)

```python
import boto3

client = boto3.client('secretsmanager')
secret = client.get_secret_value(SecretId='MySecret')
print(secret['SecretString'])
```
Този код извлича секрет от AWS Secrets Manager по сигурен начин.

## 6. Common Pitfalls

- **Съхранение на секрети в кодови репозитории** – Избягвайте да записвате пароли и ключове в source code; използвайте secrets management инструменти.
- **Използване на един и същ ключ/парола на много места** – Това увеличава риска при компрометиране; използвайте уникални ключове за различни системи.
- **Прекалено широки IAM права** – Давайте само необходимите права; ревизирайте редовно политиките.
- **Пренебрегване на ротацията на секрети** – Редовно сменяйте ключове и пароли, особено след инциденти.
- **Неактуални сертификати** – Следете за изтичащи TLS сертификати, за да избегнете прекъсване на услуги.

## 7. Short Retrieval Quiz

1. Каква е основната функция на TLS?
2. Какво представлява IAM и защо е важно?
3. Каква е разликата между публичен и частен ключ при SSH?
4. Какви са рисковете от съхранение на секрети в сорс кода?
5. Какво е Certificate Authority?
6. Какви инструменти се използват за secrets management?
7. Какво означава принципът на най-малките права?

## 8. Quick Recap

- TLS криптира комуникацията между клиенти и сървъри, предпазвайки от подслушване.
- SSH осигурява сигурен достъп до отдалечени машини чрез ключова двойка.
- IAM управлява идентичности и права за достъп до ресурси в системата.
- Secrets management гарантира сигурно съхранение и използване на чувствителни данни.
- Използвайте уникални ключове и редовно ги ротирайте.
- Никога не съхранявайте секрети в сорс кода.
- Прилагайте принципа на най-малките права за минимизиране на риска.

## 9. Spaced Review Plan

| Време      | Преговори/Примери за припомняне                                   |
|------------|------------------------------------------------------------------|
| 1 ден      | Обяснете разликата между TLS и SSH; покажете пример за SSH ключ. |
| 3 дни      | Опишете процеса на създаване на IAM роля и ротация на секрети.   |
| 1 седмица  | Дискутирайте рисковете от лошо управление на секрети.            |
| 1 месец    | Дайте пример за интеграция на secrets management в проект.        |