# Lagrange_multipliers

## 1. Activate Prior Knowledge
- Какво представлява оптимизацията и какви са някои често срещани ограничения в инженерните и AI задачи?
- Как бихте формулирали проблем, при който трябва да максимизирате или минимизирате функция, но с условие, че решенията трябва да удовлетворяват определено ограничение?
- В кои ситуации в софтуерното инженерство или машинното обучение може да се наложи да решаваме оптимизационни задачи с ограничения?

## 2. Overview
Методът на Лагранжовите множители е мощен инструмент за решаване на оптимизационни задачи с равенствени ограничения. Той позволява да се намерят екстремуми (максимуми или минимуми) на функция, като същевременно се спазват дадени условия. Това е особено важно в инженерни и AI системи, където често имаме ограничения върху параметрите – например ограничен ресурс, физически закони или бизнес правила.

В по-широк контекст, Лагранжовите множители са част от теорията на оптимизацията и играят ключова роля в машинното обучение (например при оптимизация на модели с регуляризация) и в управлението на системи с ограничения. Те ни позволяват да трансформираме ограничената оптимизация в система от уравнения, които могат да се решат с помощта на диференциално смятане.

Този метод не само улеснява намирането на решения, но и дава допълнителна информация – стойностите на Лагранжовите множители често имат интерпретация като „цената“ или „стойността“ на ограниченията, което е полезно за анализ и вземане на решения.

## 3. Key Concepts
- **Функция на целта (Objective function)** – функцията, която искаме да максимизираме или минимизираме. Можем да я мислим като „цел“ или „задача“.
- **Ограничение (Constraint)** – условие, което решенията трябва да удовлетворяват, обикновено под формата на уравнение \( g(x) = 0 \).
- **Лагранжов множител (Lagrange multiplier)** – допълнителна променлива, която „въвеждаме“, за да включим ограничението в оптимизационния проблем. Можем да си го представим като тегло, което балансира важността на ограничението.
- **Лагранжова функция (Lagrangian)** – комбинирана функция, която съчетава функцията на целта и ограниченията чрез Лагранжовите множители:  
  \[
  \mathcal{L}(x, \lambda) = f(x) - \lambda g(x)
  \]
- **Необходимите условия за оптимум** – системата от уравнения, получена чрез частични производни на Лагранжовата функция, които трябва да се удовлетворят за намиране на екстремум.

## 4. Step-by-step Learning Path
1. **Разбиране на оптимизационни задачи с ограничения**  
   - Фокус: Прегледайте примери на оптимизационни задачи с равенствени ограничения.  
   - Задача: Формулирайте прост проблем за максимизиране на функция с едно ограничение.  
   - Въпроси: Какво означава ограничението за решенията? Защо не можем просто да оптимизираме без него?

2. **Запознаване с Лагранжовата функция**  
   - Фокус: Научете как се съставя Лагранжовата функция от функцията на целта и ограниченията.  
   - Задача: Напишете Лагранжовата функция за вашия пример.  
   - Въпроси: Какво е ролята на Лагранжовия множител? Какво се случва, ако той е нула?

3. **Намиране на необходимите условия за оптимум**  
   - Фокус: Изчислете частичните производни на Лагранжовата функция и ги приравнете на нула.  
   - Задача: Решете системата уравнения за вашия пример.  
   - Въпроси: Какво означава решението на тази система? Какво ако няма решение?

4. **Интерпретиране на резултатите и множителите**  
   - Фокус: Разберете значението на стойностите на Лагранжовите множители.  
   - Задача: Анализирайте как промяна в ограничението влияе на оптималното решение.  
   - Въпроси: Какво означава голяма стойност на множителя? Как може това да помогне при инженерни решения?

5. **Прилагане в софтуер и AI системи**  
   - Фокус: Използвайте библиотека за числена оптимизация, която поддържа ограничения.  
   - Задача: Имплементирайте пример с Лагранжови множители в Python (например с `scipy.optimize`).  
   - Въпроси: Как се задават ограниченията в софтуерните инструменти? Как се интерпретират резултатите?

## 5. Examples

### Пример 1: Максимизиране на функция с едно ограничение
Нека максимизираме \( f(x,y) = xy \) при ограничение \( x^2 + y^2 = 1 \).

Лагранжова функция:  
\[
\mathcal{L}(x,y,\lambda) = xy - \lambda (x^2 + y^2 - 1)
\]

Частични производни:  
\[
\frac{\partial \mathcal{L}}{\partial x} = y - 2\lambda x = 0
\]
\[
\frac{\partial \mathcal{L}}{\partial y} = x - 2\lambda y = 0
\]
\[
\frac{\partial \mathcal{L}}{\partial \lambda} = -(x^2 + y^2 - 1) = 0
\]

Решаваме системата за \(x, y, \lambda\).

---

### Пример 2: Python код с `scipy.optimize`

```python
from scipy.optimize import minimize

def objective(x):
    return -x[0]*x[1]  # максимизираме xy, затова минимизираме -xy

def constraint(x):
    return x[0]**2 + x[1]**2 - 1  # ограничение: x^2 + y^2 = 1

cons = {'type': 'eq', 'fun': constraint}
x0 = [0.5, 0.5]  # начална точка

result = minimize(objective, x0, constraints=cons)
print("Оптимално решение:", result.x)
print("Максимална стойност:", -result.fun)
```

---

### Пример 3: Интерпретация на Лагранжов множител
В горния пример стойността на множителя \(\lambda\) показва колко се променя максималната стойност на \(f\), ако леко променим радиуса на окръжността (ограничението).

## 6. Common Pitfalls
- **Игнориране на ограниченията** – оптимизация без ограничения може да доведе до невалидни решения.
- **Неправилно формулиране на Лагранжовата функция** – забравяне на знака или неправилно включване на ограниченията.
- **Пропускане на проверка за втори ред условия** – намирането на критична точка не гарантира минимум или максимум.
- **Забравяне, че Лагранжовите множители са само за равенствени ограничения** – не всички ограничения могат да се включат по този начин.
- **Неправилна интерпретация на множителите** – те не са просто числа, а имат икономическа или физична интерпретация.

## 7. Short Retrieval Quiz
1. Какво е основната цел на метода на Лагранжовите множители?
2. Как се формира Лагранжовата функция?
3. Какво представлява Лагранжовият множител?
4. Какви условия трябва да удовлетворява оптималното решение?
5. За какъв тип ограничения е подходящ този метод?
6. Как се интерпретира стойността на Лагранжовия множител?
7. Какво се случва, ако ограничението се промени леко?

## 8. Quick Recap
- Методът на Лагранжовите множители решава оптимизационни задачи с равенствени ограничения.
- Лагранжовата функция комбинира функцията на целта и ограниченията чрез множители.
- Оптималните решения се намират чрез системата от уравнения, получена от частични производни.
- Лагранжовите множители имат интерпретация като „цена“ на ограниченията.
- Методът е широко приложим в инженерство, икономика и AI.
- Важно е да се проверяват втори ред условия за валидност на решенията.
- Софтуерни инструменти като `scipy.optimize` улесняват численото решаване.

## 9. Spaced Review Plan

| Време след учене | Промпт за преговор                                         |
|------------------|------------------------------------------------------------|
| 1 ден            | Обяснете с думи какво представлява Лагранжов множител.     |
| 3 дни            | Решете кратък пример с едно ограничение и намерете множителя.|
| 1 седмица        | Опишете как се формира Лагранжовата функция и как се решава.|
| 1 месец          | Анализирайте практическо приложение на метода в AI или инженерство. |