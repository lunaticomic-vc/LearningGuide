# 05 - Encapsulation cohesion and coupling management

## 1. Activate Prior Knowledge

- Как бихте обяснили понятието „инкапсулация“ на човек, който не е програмист? Можете ли да дадете пример от ежедневието?
- Кога сте се сблъсквали с проблеми, причинени от твърде силна свързаност (coupling) между модули в софтуерен проект?
- Как мислите, че добрата кохезия (cohesion) и ниската свързаност влияят на поддръжката и развитието на големи AI системи?

## 2. Overview

В софтуерното инженерство и изграждането на AI системи, управлението на инкапсулация, кохезия и свързаност е ключово за създаването на надежден, лесен за поддръжка и мащабируем код. Тези принципи определят как компонентите на една система взаимодействат помежду си и доколко са независими.

Инкапсулацията защитава вътрешното състояние на обектите, като скрива детайлите на имплементацията и предоставя ясен интерфейс. Кохезията измерва колко добре са свързани отговорностите в един модул, докато свързаността показва степента на зависимост между различните модули.

В контекста на AI системи, където често има множество взаимодействащи компоненти (например, обработка на данни, моделиране, визуализация), доброто управление на тези принципи води до по-лесно разширяване, тестване и интеграция на нови функционалности.

## 3. Key Concepts

- **Encapsulation (Инкапсулация)** – Процесът на скриване на вътрешната реализация на един обект и предоставяне на достъп само чрез определен интерфейс. Мислете за това като за дистанционно управление: виждате бутоните, но не и как работи електрониката вътре.
- **Cohesion (Кохезия)** – Мярка за това доколко всички елементи в един модул работят заедно за постигане на една основна цел. Високата кохезия е като добре сработен отбор, където всички имат обща задача.
- **Coupling (Свързаност)** – Степента, до която един модул зависи от други модули. Ниската свързаност е като независими отдели в компания: могат да работят самостоятелно, но комуникират чрез ясни правила.
- **Interface (Интерфейс)** – Дефинира как другите компоненти могат да взаимодействат с даден модул, без да знаят детайлите на имплементацията.
- **Information Hiding (Скриване на информация)** – Принцип, според който детайлите на имплементацията се скриват, за да се намалят грешките и да се улесни промяната на кода.

## 4. Step-by-step Learning Path

1. **Разберете инкапсулацията**
   - Фокус: Как се реализира инкапсулация в обектно-ориентиран език (например Python).
   - Задача: Създайте клас с частни (private) и публични (public) методи/атрибути.
   - Въпроси: Какви са ползите от скриването на данни? Какво би станало, ако всички атрибути са публични?

2. **Изследвайте кохезията**
   - Фокус: Различни нива на кохезия (функционална, логическа и др.).
   - Задача: Преработете клас с много несвързани методи, така че всеки клас да има само една основна отговорност.
   - Въпроси: Какво е функционална кохезия? Как се отразява ниската кохезия на поддръжката?

3. **Анализирайте свързаността**
   - Фокус: Видове свързаност (например, плътна vs. хлабава).
   - Задача: Намалете зависимостите между два класа чрез използване на интерфейси или абстракции.
   - Въпроси: Какво е loose coupling? Какви са рисковете при силна свързаност?

4. **Приложете принципите в малък проект**
   - Фокус: Интегриране на инкапсулация, кохезия и ниска свързаност в реален код.
   - Задача: Реализирайте малка система (например, библиотека за препоръчване на книги), като използвате наученото.
   - Въпроси: Какви подобрения забелязвате след рефакториране? Кои части на системата са най-лесни за промяна?

## 5. Examples

### Пример 1: Инкапсулация в Python

```python
class BankAccount:
    def __init__(self, balance):
        self.__balance = balance  # private attribute

    def deposit(self, amount):
        self.__balance += amount

    def get_balance(self):
        return self.__balance
```
*Тук балансът е скрит и достъпен само чрез методи.*

### Пример 2: Висока кохезия

```python
class EmailSender:
    def send_email(self, recipient, subject, body):
        # изпраща имейл
        pass
```
*Класът има само една отговорност – изпращане на имейли.*

### Пример 3: Намаляване на свързаността чрез интерфейс

```python
class StorageInterface:
    def save(self, data):
        pass

class FileStorage(StorageInterface):
    def save(self, data):
        # записва във файл
        pass

class DatabaseStorage(StorageInterface):
    def save(self, data):
        # записва в база данни
        pass
```
*Клиентският код работи с интерфейс, а не с конкретна имплементация.*

## 6. Common Pitfalls

- **Прекалено излагане на вътрешни данни** – Използването на публични атрибути вместо getter/setter методи води до трудно откриване на грешки.
- **Богати (God) класове** – Класове с твърде много несвързани отговорности намаляват кохезията.
- **Силна свързаност** – Когато промените в един модул изискват промени в много други, системата става крехка.
- **Липса на интерфейси/абстракции** – Пряката работа с конкретни класове затруднява разширяването и тестването.

## 7. Short Retrieval Quiz

1. Какво представлява инкапсулацията и защо е важна?
2. Каква е разликата между кохезия и свързаност?
3. Дайте пример за ниска кохезия в един клас.
4. Какви са предимствата на използването на интерфейси?
5. Как може да се намали свързаността между модули?
6. Какви са рисковете при силна свързаност?
7. Защо е важно да се скриват детайлите на имплементацията?

## 8. Quick Recap

- Инкапсулацията скрива вътрешното състояние и предоставя ясен интерфейс.
- Високата кохезия означава, че модулите имат ясна и единна отговорност.
- Ниската свързаност прави системата по-гъвкава и лесна за поддръжка.
- Интерфейсите и абстракциите улесняват разширяването и тестването на кода.
- Прекалената експозиция на вътрешни детайли води до грешки и трудна поддръжка.
- Богатите класове и силната свързаност са чести причини за проблеми в големи системи.
- Управлението на тези принципи е критично за успеха на сложни AI и софтуерни проекти.

## 9. Spaced Review Plan

| Време      | Преговори/Въпроси                                                                 |
|------------|-----------------------------------------------------------------------------------|
| 1 ден      | Обяснете с ваши думи разликата между кохезия и свързаност.                        |
| 3 дни      | Дайте пример за инкапсулация и опишете ползите ѝ в реален проект.                 |
| 1 седмица  | Идентифицирайте бог клас или силна свързаност във ваш код и предложете подобрение.|
| 1 месец    | Прегледайте проект и анализирайте дали прилагате принципите за инкапсулация, кохезия и ниска свързаност. |