# 11 - Monolithic vs microservices vs modular architectures

## 1. Activate Prior Knowledge

- Как бихте описали архитектурата на една голяма уеб или AI система, с която сте работили или за която сте чели?
- Какви предизвикателства сте срещали при промяна или разширяване на съществуващ софтуер?
- Можете ли да си представите как разделянето на една система на по-малки части може да помогне или да навреди на нейното развитие и поддръжка?

## 2. Overview

В съвременния софтуерен инженеринг архитектурните решения са от ключово значение за успеха на един проект. Три основни архитектурни подхода – монолитна, микросервизна и модулна архитектура – определят начина, по който се организират, развиват и поддържат сложни системи, включително и AI решения.

Монолитната архитектура представлява единно приложение, където всички функционалности са интегрирани в един кодов базис. Това улеснява началното разработване, но може да доведе до трудности при скалиране и поддръжка.

Микросервизната архитектура разделя системата на независими услуги, които комуникират помежду си, обикновено чрез API. Това позволява по-лесно скалиране, независими ъпдейти и по-голяма устойчивост, но изисква по-сложна инфраструктура.

Модулната архитектура е междинен подход, при който системата се разделя на ясно дефинирани модули, които могат да се развиват и тестват отделно, но често се изпълняват в един процес. Изборът между тези архитектури влияе директно върху гъвкавостта, производителността и разходите за поддръжка на софтуерните системи.

## 3. Key Concepts

- **Монолитна архитектура** – Всички компоненти на приложението са обединени в единен кодов базис и се изпълняват като един процес. Мислете за нея като за „една голяма сграда“.
- **Микросервизна архитектура** – Приложението е разделено на малки, независими услуги, всяка със собствена логика и база данни. Представете си „град от малки къщи, всяка със собствена функция“.
- **Модулна архитектура** – Системата е разделена на модули с ясни интерфейси, които често работят заедно в един процес. Аналогия: „апартаментен комплекс с отделни жилища, но общ вход“.
- **Скалируемост** – Способността на системата да се разширява с увеличаване на натоварването.
- **Свързаност (Coupling)** – Колко силно са зависими различните части на системата една от друга.
- **Самостоятелност (Autonomy)** – Степента, до която даден компонент може да функционира независимо.
- **Интерфейс** – Договорът, чрез който модулите или услугите комуникират помежду си.

## 4. Step-by-step Learning Path

1. **Разберете основите на трите архитектури**
   - Фокус: Основни характеристики, плюсове и минуси.
   - Задача: Направете кратка таблица със сравнение между монолитна, микросервизна и модулна архитектура.
   - Въпроси: Каква е основната разлика между микросервиз и модул? Кога бихте избрали монолит?

2. **Анализирайте реални системи**
   - Фокус: Идентифициране на архитектурния стил в познати приложения.
   - Задача: Изберете познат проект (например уеб приложение или AI система) и определете коя архитектура използва.
   - Въпроси: Какви са предимствата на избраната архитектура за този проект? Какви са потенциалните ѝ недостатъци?

3. **Практическо разделяне на система**
   - Фокус: Разделяне на примерна система на модули или услуги.
   - Задача: Вземете проста система (например блог платформа) и я разделете на модули или микросервизи.
   - Въпроси: Кои компоненти могат да бъдат независими? Как ще комуникират помежду си?

4. **Оценете скалируемост и поддръжка**
   - Фокус: Как архитектурният избор влияе на скалируемостта и поддръжката.
   - Задача: Опишете сценарий, в който трябва да се добави нова функционалност към всяка от архитектурите.
   - Въпроси: Коя архитектура улеснява най-много добавянето на нови функции? Защо?

5. **Рефлектирайте върху компромисите**
   - Фокус: Разбиране на компромисите между сложност, производителност и гъвкавост.
   - Задача: Напишете кратък анализ (до 100 думи) кога бихте избрали всяка архитектура.
   - Въпроси: Какви са рисковете при преждевременно преминаване към микросервизи? Какви са ползите от модулността?

## 5. Examples

### Пример 1: Монолитна архитектура

```python
# Всички функции в един файл
def register_user():
    # регистрация на потребител
    pass

def post_article():
    # публикуване на статия
    pass

def comment_article():
    # коментар към статия
    pass

# Всичко се стартира заедно
if __name__ == "__main__":
    register_user()
    post_article()
    comment_article()
```

### Пример 2: Микросервизна архитектура

- User Service (отделно приложение)
- Article Service (отделно приложение)
- Comment Service (отделно приложение)
- Всички комуникират през REST API

```python
# Примерен микросервиз: user_service.py
from flask import Flask, request

app = Flask(__name__)

@app.route('/register', methods=['POST'])
def register_user():
    # регистрация на потребител
    return "User registered"

if __name__ == "__main__":
    app.run(port=5000)
```

### Пример 3: Модулна архитектура

```python
# user_module.py
def register_user():
    pass

# article_module.py
def post_article():
    pass

# main.py
from user_module import register_user
from article_module import post_article

if __name__ == "__main__":
    register_user()
    post_article()
```

## 6. Common Pitfalls

- **Преждевременно разделяне на микросервизи** – В малки екипи или проекти това води до ненужна сложност. Започнете с монолит, когато е подходящо.
- **Липса на ясни интерфейси между модулите** – Това води до силна свързаност и трудна поддръжка. Винаги дефинирайте добре интерфейсите.
- **Недостатъчна автоматизация при микросервизи** – Без CI/CD и мониторинг, микросервизната архитектура става трудно управляема.
- **Пренебрегване на комуникационните разходи** – В микросервизите комуникацията между услугите може да доведе до латентност и грешки.
- **Смесване на бизнес логика между модулите** – Това нарушава принципа на разделение на отговорностите.

## 7. Short Retrieval Quiz

1. Каква е основната разлика между монолитна и микросервизна архитектура?
2. Какво е модулна архитектура и как се различава от микросервизната?
3. Какви са предимствата на микросервизната архитектура при големи екипи?
4. Какви са потенциалните недостатъци на монолитната архитектура при скалиране?
5. Какво означава „свързаност“ (coupling) между компонентите?
6. Защо е важно да се дефинират ясни интерфейси между модулите?
7. Какви са рисковете при преждевременно преминаване към микросервизи?

## 8. Quick Recap

- Монолитната архитектура обединява всички функции в един процес – проста, но трудна за скалиране.
- Микросервизната архитектура разделя системата на независими услуги – гъвкава, но по-сложна за поддръжка.
- Модулната архитектура структурира кода на отделни модули с ясни интерфейси – баланс между двете крайности.
- Архитектурният избор влияе на скалируемостта, поддръжката и развитието на системата.
- Ясните интерфейси и ниската свързаност са ключови за успешна модулност.
- Преждевременното разделяне на микросервизи може да доведе до ненужна сложност.
- Автоматизацията и мониторингът са критични при микросервизни архитектури.

## 9. Spaced Review Plan

| Време     | Преговорен въпрос/задача                                      |
|-----------|---------------------------------------------------------------|
| 1 ден     | Опишете с примери трите архитектури и техните основни разлики.|
| 3 дни     | Анализирайте реална система и определете нейната архитектура. |
| 1 седмица | Избройте плюсовете и минусите на всяка архитектура.           |
| 1 месец   | Решете казус: Коя архитектура бихте избрали за AI платформа?  |