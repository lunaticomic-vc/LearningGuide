# Similarity_search_applications

## 1. Activate Prior Knowledge
- Какво разбирате под "търсене на сходство" в контекста на компютърните системи и изкуствения интелект?
- Можете ли да посочите примери, където намирането на подобни обекти или данни е критично за работата на софтуер?
- Как мислите, какви алгоритми или структури от данни биха могли да подпомогнат бързото намиране на сходни елементи в големи бази данни?

## 2. Overview
Similarity search (търсене на сходство) е процесът на намиране на обекти, които са "близки" или "подобни" на даден входен обект според определена метрика за разстояние или сходство. Тази задача е фундаментална в много области на изкуствения интелект и софтуерното инженерство, включително препоръчителни системи, обработка на естествен език, компютърно зрение и биоинформатика.

В по-широк контекст similarity search е част от системи за извличане на информация и машинно обучение, където често трябва да се обработват големи обеми от данни и да се намират най-близките съседи (nearest neighbors) в многомерни пространства. Това позволява ефективно търсене, класификация и групиране на данни.

Значението на similarity search се увеличава с растежа на данните и необходимостта от бързи и точни решения в реално време. Например, в препоръчителните системи, намирането на сходни продукти или потребители подобрява персонализацията и удовлетвореността на клиентите.

## 3. Key Concepts
- **Similarity Metric** – функция, която измерва колко "близки" са два обекта. Примери включват Евклидово разстояние, косинусова близост и Jaccard индекс. Мислете за това като за "линейка", с която измерваме разстоянието между две точки в пространството на данните.
- **Nearest Neighbor Search (NNS)** – задача за намиране на обекти в база данни, които са най-близки до даден входен обект според избраната метрика. Аналогия: търсене на най-близкия приятел в голяма тълпа.
- **High-dimensional Data** – данни с много характеристики (измерения), което прави търсенето на сходство по-трудно поради "проклятието на размерността". Представете си, че търсите близки точки не в равнина, а в многоизмерно пространство.
- **Indexing Structures** – специализирани структури от данни (като KD-дървета, Ball Trees, или HNSW графи), които ускоряват similarity search, като организират данните по начин, който позволява бързо филтриране.
- **Approximate Nearest Neighbor (ANN)** – техники, които позволяват бързо намиране на "почти най-близките" съседи, компрометирайки малко точност за значително по-добра производителност.

## 4. Step-by-step Learning Path
1. **Фокус:** Разберете основните метрики за сходство и разстояния.  
   **Практическа задача:** Имплементирайте Евклидово и косинусово разстояние за вектори.  
   **Въпроси за припомняне:** Какво е косинусова близост? Защо Евклидовото разстояние не винаги е подходящо за високоизмерни данни?

2. **Фокус:** Изучете алгоритми за nearest neighbor search в нискоизмерни пространства (напр. KD-дървета).  
   **Практическа задача:** Създайте KD-дърво и тествайте търсене на най-близък съсед.  
   **Въпроси за припомняне:** Какво е KD-дърво? Как се различава от линейното търсене?

3. **Фокус:** Запознайте се с проблемите при високоизмерни данни и проклятието на размерността.  
   **Практическа задача:** Сравнете времето за търсене на най-близък съсед при 2D и 100D данни.  
   **Въпроси за припомняне:** Как проклятието на размерността влияе на similarity search?

4. **Фокус:** Изучете техники за approximate nearest neighbor (ANN), като HNSW или LSH.  
   **Практическа задача:** Инсталирайте и използвайте библиотека за ANN (например FAISS или Annoy) върху реален набор от данни.  
   **Въпроси за припомняне:** Какво е предимството на ANN спрямо точния nearest neighbor search?

5. **Фокус:** Приложете similarity search в реален проект, напр. препоръчителна система или търсене на изображения.  
   **Практическа задача:** Изградете малка система, която намира сходни документи или изображения по векторни представяния.  
   **Въпроси за припомняне:** Как similarity search подобрява потребителското изживяване в препоръчителните системи?

## 5. Examples
**Пример 1: Търсене на сходни изображения с косинусова близост**  
```python
import numpy as np
from sklearn.metrics.pairwise import cosine_similarity

# Векторни представяния на изображения (например от CNN)
image_vectors = np.array([
    [0.1, 0.3, 0.5],
    [0.2, 0.1, 0.4],
    [0.9, 0.8, 0.7]
])

query = np.array([[0.15, 0.25, 0.45]])

similarities = cosine_similarity(query, image_vectors)
most_similar_idx = np.argmax(similarities)
print(f"Най-сходното изображение е с индекс: {most_similar_idx}")
```

**Пример 2: Използване на FAISS за approximate nearest neighbor search**  
```python
import faiss
import numpy as np

d = 128  # размерност на векторите
nb = 10000  # брой базови вектори
nq = 5  # брой заявки

np.random.seed(1234)
xb = np.random.random((nb, d)).astype('float32')
xq = np.random.random((nq, d)).astype('float32')

index = faiss.IndexFlatL2(d)  # точен L2 индекс
index.add(xb)
D, I = index.search(xq, k=3)  # търсене на 3 най-близки съседи
print(I)
```

**Пример 3: Препоръчителна система с nearest neighbor search**  
- Използване на потребителски вектори за намиране на сходни потребители и препоръчване на продукти, които те харесват.

## 6. Common Pitfalls
- **Използване на неподходяща метрика** – Например Евклидово разстояние за категориални данни може да доведе до некоректни резултати. Винаги избирайте метрика според типа на данните.
- **Игнориране на проклятието на размерността** – Опити за точен nearest neighbor search в многоизмерни пространства често са бавни и неефективни.
- **Прекомерна зависимост от approximate методи без проверка на точността** – ANN методите са бързи, но винаги трябва да се оценява компромисът между точност и скорост.
- **Липса на нормализация на данните** – При косинусова близост и други метрики, нормализирането на вектори е критично за правилни резултати.
- **Недостатъчно тестване с реални данни** – Симулираните или малки набори от данни не отразяват реалните предизвикателства при similarity search.

## 7. Short Retrieval Quiz
1. Какво представлява similarity metric и защо е важна?
2. Какво е nearest neighbor search?
3. Какво е проклятието на размерността и как влияе на similarity search?
4. Каква е разликата между точен и approximate nearest neighbor search?
5. Кога е подходящо да използваме косинусова близост вместо Евклидово разстояние?
6. Какви структури от данни могат да ускорят similarity search?
7. Какво е основното предимство на ANN алгоритмите?

## 8. Quick Recap
- Similarity search намира обекти, които са близки по определена метрика.
- Метриките за сходство са ключови за измерване на разстояния между данни.
- Nearest neighbor search е основна задача, която се усложнява при висока размерност.
- Проклятието на размерността прави точните методи бавни и неефективни.
- Approximate nearest neighbor алгоритми предлагат компромис между точност и скорост.
- Правилният избор на метрика и нормализацията на данните са критични.
- Similarity search има широки приложения в препоръчителни системи, компютърно зрение и други.

## 9. Spaced Review Plan

| Време след изучаване | Преговорна задача                                  | Цел на преговора                              |
|----------------------|--------------------------------------------------|----------------------------------------------|
| 1 ден                | Обяснете с прости думи какво е similarity search | Активиране на основните понятия              |
| 3 дни                | Имплементирайте две метрики за сходство          | Затвърждаване на ключови концепции           |
| 1 седмица            | Сравнете KD-дърво и ANN подходи                   | Разбиране на алгоритмичните различия          |
| 1 месец              | Изградете малък проект с similarity search       | Приложение на знанията в реален контекст     |