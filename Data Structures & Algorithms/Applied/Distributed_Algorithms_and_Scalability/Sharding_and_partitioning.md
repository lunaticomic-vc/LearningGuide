# Sharding_and_partitioning

## 1. Activate Prior Knowledge

- Какво представлява разделянето на данни в големи софтуерни системи и защо е необходимо?
- Какви проблеми могат да възникнат при обработката на огромни обеми данни в AI системи без подходящо разпределение?
- Можете ли да предвидите как разпределянето на данни влияе върху мащабируемостта и производителността на база данни?

## 2. Overview

Sharding и partitioning са техники за разделяне на големи набори от данни на по-малки, по-лесно управляеми части. Това позволява системите да обработват и съхраняват огромни обеми информация, като подобряват производителността и мащабируемостта. В контекста на AI и софтуерното инженерство, тези техники са ключови за ефективното управление на данни, особено при разпределени системи и бази данни.

Partitioning обикновено се отнася до логическото разделяне на данни в рамките на една база данни или таблица, докато sharding е по-широко и включва физическо разпределение на данни между различни сървъри или машини. Тези подходи помагат за намаляване на натоварването върху отделни компоненти и подобряват времето за отговор на заявки.

Важността на sharding и partitioning се проявява най-вече при системи с голям трафик и огромни обеми данни, като социални мрежи, онлайн магазини и AI платформи, където бързината и надеждността са критични.

## 3. Key Concepts

- **Partitioning** – Логическо разделяне на данни в рамките на една база данни или таблица, което позволява по-лесно управление и по-бърз достъп. Може да се сравни с разделянето на книга на глави за по-лесно намиране на информация.
- **Sharding** – Физическо разпределение на данни между различни сървъри или машини, подобно на разпределянето на задачи между няколко работника, за да се ускори обработката.
- **Horizontal Partitioning** – Разделяне на редове (записи) от таблица на различни части, всяка съдържаща различен набор от записи.
- **Vertical Partitioning** – Разделяне на колони (атрибути) на таблица, така че различни части съдържат различни колони.
- **Shard Key** – Ключът или критерия, по който се определя към кой shard ще попадне даден запис. Изборът на shard key е критичен за балансираното разпределение на данните.
- **Rebalancing** – Процесът на преразпределяне на данни между shards, когато някои от тях се претоварват.
- **Consistency** – Гаранция, че всички копия на данните са актуални и съгласувани, което е предизвикателство при разпределени системи.

## 4. Step-by-step Learning Path

1. **Разберете основните принципи на partitioning и sharding**
   - Фокус: Разграничете логическото и физическото разделяне на данни.
   - Задача: Напишете кратко резюме с примери за partitioning и sharding.
   - Въпроси: Какво е основната разлика между partitioning и sharding? Защо е важно да ги различаваме?

2. **Изучете различните видове partitioning**
   - Фокус: Хоризонтално и вертикално разделяне.
   - Задача: Създайте примерна таблица и я разделете хоризонтално и вертикално.
   - Въпроси: Кога е по-подходящо хоризонталното partitioning? Какви са предимствата на вертикалното partitioning?

3. **Разберете ролята на shard key и неговото влияние**
   - Фокус: Избор на shard key и баланс на натоварването.
   - Задача: Изберете shard key за примерна база данни с потребителски записи.
   - Въпроси: Какво може да се случи, ако shard key е лошо избран? Как shard key влияе на производителността?

4. **Практикувайте имплементация на sharding**
   - Фокус: Конфигуриране на sharding в популярна база данни (например MongoDB или Cassandra).
   - Задача: Настройте прост sharding на тестова база данни и изпълнете заявки.
   - Въпроси: Какви са предизвикателствата при изпълнение на заявки върху sharded база?

5. **Изучете техники за rebalancing и управление на консистентността**
   - Фокус: Поддържане на баланс и консистентност в разпределени системи.
   - Задача: Анализирайте сценарий с претоварен shard и предложете решение.
   - Въпроси: Как се осъществява rebalancing? Какви компромиси има между консистентност и наличност?

## 5. Examples

### Пример 1: Хоризонтално partitioning на таблица с потребители

```sql
-- Таблица с потребители, разделена по регион
CREATE TABLE users_europe AS SELECT * FROM users WHERE region = 'Europe';
CREATE TABLE users_asia AS SELECT * FROM users WHERE region = 'Asia';
```

### Пример 2: Sharding в MongoDB

```javascript
// Активиране на sharding за база данни
sh.enableSharding("myDatabase");

// Избор на shard key и sharding на колекция
sh.shardCollection("myDatabase.users", { user_id: 1 });
```

### Пример 3: Вертикално partitioning на таблица с клиенти

| Клиент_ID | Име | Адрес | Телефон | Имейл |
|-----------|-----|-------|---------|-------|

Вертикално partitioning:

- Таблица Клиенти_Основни (Клиент_ID, Име, Телефон)
- Таблица Клиенти_Адреси (Клиент_ID, Адрес, Имейл)

## 6. Common Pitfalls

- **Лош избор на shard key** – води до неравномерно разпределение на данните и претоварване на някои shards. Избягвайте ключове с ниска картина или силно концентрирани стойности.
- **Пренебрегване на консистентността** – при разпределени системи е лесно да се получат несъответствия, ако не се управлява правилно.
- **Прекалено фино partitioning** – може да доведе до прекомерна сложност и загуба на производителност.
- **Игнориране на rebalancing** – без периодично преразпределяне на данните, системата може да се забави или да се срине.
- **Недостатъчно тестване на заявки върху sharded данни** – някои заявки могат да станат по-бавни или да изискват сложни операции.

## 7. Short Retrieval Quiz

1. Каква е основната разлика между partitioning и sharding?
2. Какво представлява shard key и защо е важен?
3. Кога е подходящо хоризонталното partitioning?
4. Какво е rebalancing и кога се налага?
5. Какви проблеми могат да възникнат при лош избор на shard key?
6. Как partitioning подобрява производителността на база данни?
7. Какви са основните предизвикателства при поддържане на консистентност в sharded системи?

## 8. Quick Recap

- Partitioning и sharding са техники за разделяне на данни с цел подобряване на мащабируемост и производителност.
- Partitioning е логическо разделяне, а sharding – физическо разпределение на данни.
- Хоризонталното partitioning разделя записи, вертикалното – колони.
- Изборът на shard key е критичен за балансирано разпределение и ефективност.
- Rebalancing помага да се избегне претоварване на отделни shards.
- Консистентността е предизвикателство при разпределени системи и изисква специално внимание.
- Практическата имплементация изисква тестване и наблюдение на системата.

## 9. Spaced Review Plan

| Време след учене | Промпт за преговор                                      |
|------------------|---------------------------------------------------------|
| 1 ден            | Обяснете разликата между partitioning и sharding.       |
| 3 дни            | Избройте и опишете видовете partitioning.               |
| 1 седмица        | Как се избира shard key и какви са последствията?       |
| 1 месец          | Опишете процеса на rebalancing и защо е важен.           |