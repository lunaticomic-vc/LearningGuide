# Function_calling_and_schema_definition

## 1. Activate Prior Knowledge
- Какво представлява функцията в програмирането и как се извиква тя?
- Какви са предимствата на дефинирането на ясен интерфейс (схема) за функции в софтуерни системи?
- Как мислите, че функцията и нейната схема могат да помогнат при интеграция на AI модели с външни системи?

## 2. Overview
Функционалното извикване (function calling) е основен механизъм в програмирането и софтуерната архитектура, чрез който една част от кода (функция) се изпълнява с определени входни параметри и връща резултат. В контекста на AI системи, особено при интеграция с езикови модели, функцията служи като мост между естествения език и конкретни операции или заявки към външни услуги.

Схемата (schema definition) описва структурата на входните и изходните данни за функцията – какви параметри приема, какъв тип са те и какъв резултат се очаква. Това е критично за надеждност, валидиране и автоматизация, тъй като позволява на системата да разбира и контролира как да извика функцията правилно.

В по-широк контекст, правилното дефиниране на функции и техните схеми подобрява модулността, повторната употреба и поддръжката на софтуера. В AI приложения, това позволява на езиковите модели да взаимодействат с реални данни и услуги по структуриран и предвидим начин, което повишава ефективността и точността на системата.

## 3. Key Concepts
- **Function (Функция)** – блок код, който изпълнява определена задача и може да приема входни параметри и да връща резултат. Мислете за функцията като за „черна кутия“, която трансформира входа в изход.
- **Function Calling (Извикване на функция)** – процесът на активиране на функция с конкретни аргументи, за да се изпълни нейното действие.
- **Schema Definition (Дефиниция на схема)** – формално описание на структурата и типовете на входните и изходните данни на функцията. Аналогично на договор, който уточнява какви данни се очакват.
- **Parameters (Параметри)** – входните стойности, които функцията приема, за да изпълни задачата си.
- **Return Type (Тип на връщаната стойност)** – типът на данните, които функцията връща след изпълнение.
- **Validation (Валидация)** – процесът на проверка дали подадените данни отговарят на схемата, преди функцията да бъде извикана.
- **API (Application Programming Interface)** – интерфейс, който позволява на различни софтуерни компоненти да комуникират, често чрез дефинирани функции и схеми.

## 4. Step-by-step Learning Path
1. **Разберете основите на функциите и техните параметри**  
   *Задача:* Напишете проста функция на предпочитан език, която приема два параметъра и връща тяхната сума.  
   *Въпроси:* Какво е параметър? Какво връща функцията?

2. **Изучете как се дефинира схема за функция**  
   *Задача:* Опишете схема на функцията от стъпка 1, включително типовете на параметрите и връщаната стойност (например JSON Schema).  
   *Въпроси:* Защо е важно да дефинираме типа на параметрите? Как схемата помага при валидация?

3. **Практикувайте извикване на функция с валидирани данни**  
   *Задача:* Имплементирайте проверка, която валидира входните данни спрямо схемата преди извикване на функцията.  
   *Въпроси:* Какво се случва, ако подадените данни не отговарят на схемата? Как може да се обработи тази грешка?

4. **Свържете функция и схема с AI система (например езиков модел)**  
   *Задача:* Създайте пример, в който езиков модел генерира извикване на функция с параметри, валидирани спрямо схема.  
   *Въпроси:* Как езиковият модел използва схемата, за да форматира извикването? Как това подобрява взаимодействието?

5. **Изследвайте сложни схеми и вложени структури**  
   *Задача:* Дефинирайте схема с вложени обекти и масиви за функция, която обработва по-сложни данни.  
   *Въпроси:* Как се описват вложени структури в схемата? Как това влияе на валидирането?

## 5. Examples

### Пример 1: Проста функция и схема на Python
```python
def add_numbers(a: int, b: int) -> int:
    return a + b

# Схема (JSON Schema)
add_numbers_schema = {
    "type": "object",
    "properties": {
        "a": {"type": "integer"},
        "b": {"type": "integer"}
    },
    "required": ["a", "b"]
}
```

### Пример 2: Извикване на функция с валидиране на входни данни
```python
import jsonschema

input_data = {"a": 5, "b": 7}

try:
    jsonschema.validate(instance=input_data, schema=add_numbers_schema)
    result = add_numbers(**input_data)
    print("Result:", result)
except jsonschema.ValidationError as e:
    print("Invalid input:", e)
```

### Пример 3: AI езиков модел генерира извикване на функция (псевдо код)
```json
{
  "function_call": {
    "name": "add_numbers",
    "parameters": {
      "a": 10,
      "b": 20
    }
  }
}
```
Този формат позволява на AI системата да комуникира с функцията по структуриран начин.

## 6. Common Pitfalls
- **Липса на ясна схема** – без дефинирана схема входните данни могат да са неконсистентни, което води до грешки при изпълнение.
- **Неправилно валидиране на параметрите** – пропускането на проверка може да доведе до сривове или непредвидено поведение.
- **Схема, която не отразява реалната функция** – несъответствия между описанието и кода затрудняват поддръжката и интеграцията.
- **Прекалено сложни или нечетими схеми** – правят кода труден за разбиране и използване.
- **Игнориране на грешки при извикване** – неадекватната обработка на грешки при невалидни данни води до нестабилност.

## 7. Short Retrieval Quiz
1. Какво представлява функцията в програмирането?
2. Защо е важно да дефинираме схема за функция?
3. Какво означава валидиране на параметри?
4. Какво може да се случи, ако подадем невалидни данни на функция?
5. Как функцията и схемата помагат при интеграция с AI модели?
6. Какво е параметър на функция?
7. Какво е тип на връщаната стойност?

## 8. Quick Recap
- Функцията е блок код, който приема параметри и връща резултат.
- Схемата описва структурата и типовете на входните и изходните данни.
- Валидирането гарантира, че входните данни съответстват на схемата.
- Ясната дефиниция на функции и схеми подобрява надеждността и поддръжката.
- В AI системи схемите позволяват структурирано и предвидимо извикване на функции.
- Често срещани грешки са липса на схема и неправилна валидация.
- Практическото упражнение включва писане на функции, дефиниране на схеми и валидиране.

## 9. Spaced Review Plan

| Време след учене | Промпт за преглед                                         |
|-------------------|----------------------------------------------------------|
| 1 ден             | Обяснете какво е функция и защо е важна схемата ѝ.       |
| 3 дни             | Опишете стъпките за валидиране на входни данни по схема. |
| 1 седмица         | Дайте пример за функция с вложена схема и обяснете.      |
| 1 месец           | Как функцията и схемата подобряват взаимодействието с AI? |