# Network_flow_algorithms

## 1. Activate Prior Knowledge
- Какво представлява потокът в мрежа и как бихте го свързали с реални системи като транспортни мрежи или комуникационни системи?
- Как алгоритмите за оптимизация и графовите структури могат да помогнат при решаването на задачи, свързани с максимален поток?
- Как мислите, че концепцията за поток в мрежа може да бъде приложена в изкуствения интелект или софтуерното инженерство, например при оптимизация на ресурси?

## 2. Overview
Алгоритмите за поток в мрежа са фундаментални инструменти в теорията на графите и оптимизацията, които позволяват намирането на максималния възможен поток от източник към приемник в мрежа с капацитети по ребрата. Те намират приложение в широк спектър от области, включително комуникационни мрежи, логистика, планиране на ресурси и дори в някои аспекти на изкуствения интелект, като оптимизация на разпределението на задачи.

В контекста на софтуерното инженерство, тези алгоритми са ключови за моделиране и решаване на проблеми, свързани с разпределение на капацитети, управление на ресурси и оптимизация на потоци в системи. Те също така служат като основа за по-сложни алгоритми и техники, като минимален разрез, двоични потоци и задачи за съвпадение.

Разбирането на тези алгоритми не само развива уменията за работа с графи, но и подобрява способността за системно мислене и решаване на комплексни инженерни проблеми, което е от съществено значение за професионалистите в областта на компютърните науки и изкуствения интелект.

## 3. Key Concepts
- **Flow (Поток)** – Количеството "материал" (напр. данни, вода, стоки), което преминава през ребрата на мрежата от източника към приемника. Мислете за поток като вода, която тече през тръби с ограничен капацитет.
- **Capacity (Капацитет)** – Максималното количество поток, което реброто може да поеме. Представете си тръба с определен диаметър, който ограничава колко вода може да премине.
- **Residual Graph (Остатъчна мрежа)** – Мрежа, която показва колко още поток може да се изпрати по всяко ребро, включително възможността за връщане на поток назад.
- **Augmenting Path (Път за увеличаване на потока)** – Път от източника до приемника в остатъчната мрежа, по който може да се увеличи потокът.
- **Max Flow (Максимален поток)** – Най-голямото възможно количество поток, което може да премине от източника към приемника без да се нарушават капацитетите.
- **Min Cut (Минимален разрез)** – Разделяне на върховете на мрежата на две части, така че сумарният капацитет на ребрата, пресичащи разделянето, е минимален. Свързано е с максималния поток чрез теоремата за максимален поток – минимален разрез.
- **Ford-Fulkerson Algorithm** – Класически алгоритъм за намиране на максимален поток чрез итеративно намиране на пътища за увеличаване на потока.
- **Edmonds-Karp Algorithm** – Имплементация на Ford-Fulkerson, която използва BFS за намиране на най-късите пътища за увеличаване, гарантирайки полиномиално време.
- **Dinic's Algorithm** – По-ефективен алгоритъм, който използва нива на графа и блокиращи потоци за по-бързо намиране на максимален поток.

## 4. Step-by-step Learning Path
1. **Запознаване с основните понятия на мрежовия поток**
   - Фокус: Разберете какво е поток, капацитет и остатъчна мрежа.
   - Задача: Нарисувайте малка мрежа с капацитети и изчислете максимален поток ръчно.
   - Въпроси: Какво представлява остатъчната мрежа? Защо е важна?

2. **Изучаване на Ford-Fulkerson алгоритъма**
   - Фокус: Разберете как се намират пътища за увеличаване и как се актуализира потокът.
   - Задача: Имплементирайте Ford-Fulkerson на малка мрежа и проследете стъпките.
   - Въпроси: Какво се случва, ако няма път за увеличаване? Как се обновява остатъчната мрежа?

3. **Оптимизация с Edmonds-Karp алгоритъма**
   - Фокус: Използване на BFS за намиране на най-късите пътища.
   - Задача: Имплементирайте Edmonds-Karp и сравнете с Ford-Fulkerson по време на изпълнение.
   - Въпроси: Защо BFS гарантира полиномиално време? Какво е значението на най-късия път?

4. **Изучаване на Dinic's алгоритъма**
   - Фокус: Разберете концепцията за нива и блокиращи потоци.
   - Задача: Имплементирайте Dinic's алгоритъм и го тествайте на по-големи мрежи.
   - Въпроси: Какво е блокиращ поток? Какво прави Dinic по-бърз от Edmonds-Karp?

5. **Приложения и разширения**
   - Фокус: Изследвайте приложения като минимален разрез, задачи за съвпадение и мултикомодови потоци.
   - Задача: Решете задача за минимален разрез, използвайки максимален поток.
   - Въпроси: Как се свързва максималният поток с минималния разрез? Как може да се използва този алгоритъм в AI?

## 5. Examples

### Пример 1: Максимален поток в транспортна мрежа
Имаме мрежа с 4 върха и капацитети по ребрата. Целта е да намерим максималния поток от връх 0 (източник) до връх 3 (приемник).

```python
from collections import deque

def bfs(C, F, s, t):
    queue = deque([s])
    paths = {s: []}
    while queue:
        u = queue.popleft()
        for v in range(len(C)):
            if C[u][v] - F[u][v] > 0 and v not in paths:
                paths[v] = paths[u] + [(u,v)]
                if v == t:
                    return paths[v]
                queue.append(v)
    return None

def max_flow(C, s, t):
    n = len(C)
    F = [[0]*n for _ in range(n)]
    path = bfs(C, F, s, t)
    while path:
        flow = min(C[u][v] - F[u][v] for u,v in path)
        for u,v in path:
            F[u][v] += flow
            F[v][u] -= flow
        path = bfs(C, F, s, t)
    return sum(F[s][i] for i in range(n))

C = [
    [0, 3, 2, 0],
    [0, 0, 5, 2],
    [0, 0, 0, 3],
    [0, 0, 0, 0]
]

print("Максимален поток:", max_flow(C, 0, 3))
```

### Пример 2: Минимален разрез чрез максимален поток
След като намерим максимален поток, върховете достижими от източника в остатъчната мрежа формират едната част на минималния разрез.

### Пример 3: Приложение в AI – оптимизация на разпределение на задачи
В системи за разпределение на задачи, където ресурсите са ограничени, алгоритмите за максимален поток могат да помогнат за оптимално разпределение, гарантирайки максимално използване на наличните ресурси.

## 6. Common Pitfalls
- **Игнориране на остатъчната мрежа** – без правилно обновяване на остатъчната мрежа алгоритъмът няма да намери максималния поток.
- **Избор на пътища за увеличаване без стратегия** – използването на DFS в Ford-Fulkerson може да доведе до експоненциално време.
- **Неправилно обработване на обратните ребра** – важно е да се намалява потокът по обратните ребра при актуализация.
- **Липса на проверка за цикли или застой** – алгоритъмът трябва да спре, когато няма път за увеличаване.
- **Грешки при имплементация на BFS/DFS** – неправилно търсене може да пропусне валидни пътища.

## 7. Short Retrieval Quiz
1. Какво представлява остатъчната мрежа?
2. Каква е ролята на пътя за увеличаване на потока?
3. Какво гарантира използването на BFS в Edmonds-Karp алгоритъма?
4. Как се свързват максималният поток и минималният разрез?
5. Какво представлява блокиращият поток в Dinic's алгоритъма?
6. Защо е важно да се обработват обратните ребра при актуализация на потока?
7. Кога алгоритъмът за максимален поток спира да търси пътища за увеличаване?

## 8. Quick Recap
- Потокът в мрежа моделира пренос на ресурси през граф с капацитети.
- Максималният поток е най-голямото количество ресурс, което може да премине от източник към приемник.
- Остатъчната мрежа показва възможностите за допълнителен поток и връщане назад.
- Ford-Fulkerson, Edmonds-Karp и Dinic са основни алгоритми за намиране на максимален поток.
- Максималният поток и минималният разрез са тясно свързани чрез фундаментална теорема.
- Правилната имплементация и избор на стратегия за търсене са ключови за ефективността.
- Алгоритмите намират широко приложение в инженерни и AI системи за оптимизация.

## 9. Spaced Review Plan

| Време след учене | Прегледна задача                            | Цел на прегледа                       |
|------------------|--------------------------------------------|-------------------------------------|
| 1 ден            | Прегледайте дефинициите на поток и капацитет | Утвърждаване на основни понятия     |
| 3 дни            | Имплементирайте Ford-Fulkerson на малка мрежа | Практическо затвърждаване на алгоритъм |
| 1 седмица        | Обяснете връзката между максимален поток и минимален разрез | Концептуално разбиране               |
| 1 месец          | Решете задача с Dinic's алгоритъм на по-голяма мрежа | Дългосрочно задълбочаване и умения  |