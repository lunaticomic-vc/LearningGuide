# Load_factor_and_rehashing

## 1. Activate Prior Knowledge
- Какво представлява хеш таблицата и защо е важна в софтуерното инженерство и AI системите?
- Как мислите, че се държи производителността на хеш таблица при увеличаване на броя на елементите в нея?
- Как бихте се справили с проблема, когато множество ключове се хешират към една и съща позиция?

## 2. Overview
Load factor (натоварване) и rehashing (прехеширане) са ключови концепции за поддържане на ефективността на хеш таблиците, които са основна структура от данни в много AI системи и софтуерни приложения. Load factor измерва съотношението между броя на съхранените елементи и капацитета на таблицата, което влияе директно върху скоростта на операции като търсене, вмъкване и изтриване.

Когато load factor надвиши определена граница, производителността на хеш таблицата започва да спада, тъй като се увеличава броят на колизиите. Rehashing е процесът на създаване на нова, по-голяма хеш таблица и прехвърляне на всички съществуващи елементи в нея чрез нова хеш функция или увеличен капацитет. Това поддържа нисък load factor и осигурява бърз достъп до данните.

В контекста на AI системи, където обработката на големи обеми данни и бързото търсене са критични, правилното управление на load factor и rehashing е от съществено значение за оптимална работа на алгоритмите и системите.

## 3. Key Concepts
- **Load Factor (Натоварване)** – съотношението между броя на елементите в хеш таблицата и общия ѝ капацитет. Представете си го като степента на запълване на стая с кутии: колкото повече кутии има, толкова по-трудно е да намериш свободно място.
- **Rehashing (Прехеширане)** – процесът на създаване на нова, по-голяма хеш таблица и прехвърляне на всички елементи от старата таблица в новата, за да се намалят колизиите и да се подобри производителността.
- **Collision (Колизия)** – ситуация, в която два различни ключа се хешират към една и съща позиция в таблицата. Представете си две писма, адресирани до една и съща пощенска кутия.
- **Hash Function (Хеш функция)** – функция, която преобразува ключа в индекс в хеш таблицата. Тя трябва да бъде бърза и да разпределя ключовете равномерно.
- **Capacity (Капацитет)** – максималният брой елементи, които хеш таблицата може да съхранява преди да се наложи rehashing.

## 4. Step-by-step Learning Path
1. **Разберете основите на хеш таблиците**
   - Фокус: Как работи хеш таблицата и какво представлява хеш функцията.
   - Задача: Имплементирайте проста хеш таблица с фиксиран капацитет.
   - Въпроси: Какво се случва при колизия? Защо хеш функцията трябва да е равномерна?

2. **Изследвайте load factor и неговото влияние**
   - Фокус: Изчисляване на load factor и наблюдение на ефекта му върху производителността.
   - Задача: Добавете метод за изчисляване на load factor в имплементацията.
   - Въпроси: Как се променя load factor при добавяне на елементи? Какво се случва, ако load factor е много висок?

3. **Научете кога и как се прави rehashing**
   - Фокус: Тригериране на rehashing при достигане на прагов load factor.
   - Задача: Добавете механизъм за автоматично прехеширане при достигане на определен load factor.
   - Въпроси: Какво се случва по време на rehashing? Защо е важно капацитетът да се увеличава?

4. **Оптимизирайте хеш функцията и капацитета**
   - Фокус: Избор на подходящ капацитет (например простите числа) и хеш функции.
   - Задача: Тествайте различни капацитети и хеш функции, измерете ефективността.
   - Въпроси: Как изборът на капацитет влияе на колизиите? Какво прави една хеш функция добра?

5. **Приложете знанията в реален проект**
   - Фокус: Използване на хеш таблици с rehashing в AI или софтуерен проект.
   - Задача: Интегрирайте разширяема хеш таблица в проект за бързо търсене на данни.
   - Въпроси: Как rehashing влияе на производителността в реални условия? Как да минимизирате времето за rehash?

## 5. Examples
### Пример 1: Изчисляване на load factor
```python
class HashTable:
    def __init__(self, capacity=10):
        self.capacity = capacity
        self.size = 0
        self.table = [None] * capacity

    def load_factor(self):
        return self.size / self.capacity

# Примерна употреба
ht = HashTable()
print(ht.load_factor())  # 0.0
ht.size = 5
print(ht.load_factor())  # 0.5
```

### Пример 2: Прехеширане при достигане на load factor 0.7
```python
def rehash(self):
    old_table = self.table
    self.capacity *= 2
    self.table = [None] * self.capacity
    self.size = 0

    for item in old_table:
        if item is not None:
            self.insert(item)

def insert(self, key):
    if self.load_factor() > 0.7:
        self.rehash()
    # Логика за вмъкване на ключа
```

### Пример 3: Колизия и линейно пробиране
```python
def insert(self, key):
    index = self.hash_function(key)
    while self.table[index] is not None:
        index = (index + 1) % self.capacity
    self.table[index] = key
    self.size += 1
```

## 6. Common Pitfalls
- **Игнориране на load factor** – не следенето на load factor води до спад в производителността и повече колизии.
- **Прехеширане твърде късно или твърде рано** – ако се прави прекалено често, системата губи време; ако се прави късно, таблицата е претоварена.
- **Лош избор на капацитет** – използването на числа, които не са прости, може да увеличи колизиите.
- **Неправилна имплементация на rehashing** – пропускане на прехвърляне на всички елементи или неправилно обновяване на капацитета.
- **Неоптимални хеш функции** – водят до неравномерно разпределение и повече колизии.

## 7. Short Retrieval Quiz
1. Какво представлява load factor и как се изчислява?
2. Защо е важно да се прави rehashing?
3. Какво е колизия в контекста на хеш таблиците?
4. Какво се случва по време на процеса на rehashing?
5. Как изборът на капацитет влияе на производителността на хеш таблицата?
6. Кога трябва да се задейства прехеширане?
7. Какво може да се случи, ако не се следи load factor?

## 8. Quick Recap
- Load factor измерва степента на запълване на хеш таблицата.
- Висок load factor увеличава броя на колизиите и забавя операциите.
- Rehashing създава нова, по-голяма таблица и прехвърля елементите, за да поддържа нисък load factor.
- Изборът на капацитет и хеш функция е критичен за ефективността.
- Колизиите са неизбежни, но могат да се управляват чрез подходящи методи като линейно пробиране и rehashing.
- В AI системи, правилното управление на тези процеси осигурява бърз достъп до големи обеми данни.
- Неправилната имплементация води до сериозни проблеми с производителността.

## 9. Spaced Review Plan

| Време след учене | Прегледна задача                                    |
|------------------|----------------------------------------------------|
| 1 ден            | Обяснете с прости думи какво е load factor и rehashing. |
| 3 дни            | Имплементирайте функция за изчисляване на load factor и тригер за rehashing. |
| 1 седмица        | Анализирайте влиянието на различни капацитети върху производителността. |
| 1 месец          | Приложете rehashing в реален проект и оценете ефекта върху скоростта. |