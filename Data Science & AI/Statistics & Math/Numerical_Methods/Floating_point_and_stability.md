# Floating_point_and_stability

## 1. Activate Prior Knowledge

- Какво знаете за начина, по който компютрите представят реални числа? Какво е плаваща запетая?
- Защо смятате, че точността на числовите изчисления е критична в системи за изкуствен интелект и софтуерно инженерство?
- Можете ли да предвидите как грешки при представяне на числа могат да повлияят на стабилността на алгоритъм?

## 2. Overview

В съвременните компютърни системи реалните числа се представят чрез формата на плаваща запетая (floating point). Този формат позволява да се работи с много големи и много малки числа, но с ограничена точност. В контекста на изчислителната математика и инженерството, разбирането на представянето на числата с плаваща запетая е фундаментално за избягване на грешки и нестабилност.

Стабилността на числените алгоритми се отнася до тяхната устойчивост към малки грешки или закръглявания, които неизбежно възникват при работа с плаваща запетая. В системи за изкуствен интелект, където често се използват големи матрици и сложни изчисления, нестабилността може да доведе до значителни отклонения и неправилни резултати.

Този материал ще ви помогне да изградите дълбоко и практично разбиране за това как работи плаващата запетая, как се проявява нестабилността и как да проектирате и анализирате алгоритми, които са устойчиви на числени грешки.

## 3. Key Concepts

- **Плаваща запетая (Floating Point)** – начин за представяне на реални числа в компютъра чрез мантиса и експонента, позволяващ широк диапазон, но с ограничена точност. Може да се сравни с научна нотация, но с фиксиран брой цифри.
- **Закръгляване (Rounding Error)** – грешка, която възниква, когато резултатът от изчисление не може да бъде точно представен в ограниченото пространство на плаващата запетая.
- **Нестабилност (Numerical Instability)** – състояние, при което малки грешки в данните или изчисленията се усилват и водят до големи отклонения в резултатите.
- **Условие на задачата (Condition Number)** – мярка за чувствителността на резултата към малки промени във входните данни. Високото условие означава, че задачата е "лошо кондиционирана".
- **Арифметика с плаваща запетая IEEE 754** – стандарт, който дефинира формата и операциите с плаваща запетая, широко използван в хардуера и софтуера.
- **Кумулативна грешка (Error Propagation)** – натрупване на малки грешки през поредица от операции, което може да доведе до значителна неточност.

## 4. Step-by-step Learning Path

1. **Запознайте се с формата на плаващата запетая**
   - Фокус: Разберете структурата на числото с плаваща запетая (знак, експонента, мантиса).
   - Задача: Използвайте онлайн инструмент или програма, за да разгледате двоичното представяне на няколко реални числа.
   - Въпроси: Какво представлява мантисата? Каква е ролята на експонентата?

2. **Изследвайте ефекта на закръгляването**
   - Фокус: Разберете как закръгляването влияе на резултатите от изчисления.
   - Задача: Напишете малка програма, която сумира много малки числа и наблюдавайте как се натрупват грешки.
   - Въпроси: Защо сумата на много малки числа може да се различава от очакваната? Какво е машинното епсилон?

3. **Проучете условието на задачата и стабилността**
   - Фокус: Научете как да оценявате чувствителността на алгоритмите към грешки.
   - Задача: Анализирайте условието на проста линейна система и експериментирайте с малки промени във входа.
   - Въпроси: Какво означава високо условие? Как се отразява на стабилността?

4. **Практикувайте с числени алгоритми**
   - Фокус: Разгледайте примери на стабилни и нестабилни алгоритми (напр. решаване на линейни уравнения).
   - Задача: Имплементирайте два метода за решаване на система и сравнете резултатите.
   - Въпроси: Кой метод е по-стабилен и защо? Как грешките се разпространяват?

5. **Прилагайте знанията в AI и инженерни задачи**
   - Фокус: Разберете как плаващата запетая и стабилността влияят на модели за машинно обучение.
   - Задача: Анализирайте как числената нестабилност може да повлияе на обучение на невронна мрежа.
   - Въпроси: Какви са рисковете от нестабилност в AI? Как да ги минимизираме?

## 5. Examples

### Пример 1: Закръгляване при сумиране

```python
# Сумиране на много малки числа
total = 0.0
for _ in range(1000000):
    total += 1e-10
print(total)  # Очакван резултат: 0.0001, но може да има грешка
```

### Пример 2: Нестабилност при решаване на линейна система

```python
import numpy as np

A = np.array([[1, 1], [1, 1.000001]])
b = np.array([2, 2.000001])
x = np.linalg.solve(A, b)
print(x)  # Малка промяна в A води до голяма промяна в x
```

### Пример 3: Влияние на машинното епсилон

```python
import sys
print(sys.float_info.epsilon)  # Най-малката разлика, която може да се различи от 1.0
```

## 6. Common Pitfalls

- **Игнориране на машинното епсилон** – подценяване на минималната разлика, която компютърът може да различи, води до грешки при сравнения.
- **Неправилен избор на алгоритъм** – използване на нестабилни методи за решаване на задачи, което усилва грешките.
- **Натрупване на грешки** – при многократни операции без контрол, грешките се натрупват и изкривяват резултатите.
- **Пряко сравнение на числа с плаваща запетая** – вместо това трябва да се използват толеранси.
- **Пренебрегване на условието на задачата** – неоценяването на чувствителността води до изненадващи резултати.

## 7. Short Retrieval Quiz

1. Какво представлява числото с плаваща запетая?
2. Какво е машинно епсилон и защо е важно?
3. Какво означава числена нестабилност?
4. Какво е условието на задачата?
5. Защо пряката проверка на равенство между две числа с плаваща запетая е опасна?
6. Как се натрупват грешките при изчисления?
7. Какви са последиците от използването на нестабилни алгоритми?

## 8. Quick Recap

- Числата с плаваща запетая позволяват представяне на реални числа с ограничена точност.
- Закръгляването и машинното епсилон са ключови фактори за точността на изчисленията.
- Нестабилността е усилване на малки грешки, което може да доведе до значителни отклонения.
- Условие на задачата измерва чувствителността на резултата към входните данни.
- Изборът на стабилен алгоритъм е критичен за надеждността на изчисленията.
- В AI системи числената стабилност влияе върху качеството и надеждността на моделите.
- Практическото разбиране и тестване са необходими за избягване на често срещани грешки.

## 9. Spaced Review Plan

| Време след учене | Промпт за преглед                                      |
|------------------|-------------------------------------------------------|
| 1 ден            | Обяснете какво е плаваща запетая и защо е важна.      |
| 3 дни            | Дайте пример за числена нестабилност и как да я избегнем. |
| 1 седмица        | Опишете как условието на задачата влияе на резултатите. |
| 1 месец          | Прегледайте и сравнете стабилни и нестабилни алгоритми. |