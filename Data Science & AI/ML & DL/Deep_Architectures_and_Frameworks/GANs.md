# GANs

## 1. Activate Prior Knowledge
- Какво представляват генеративните модели в машинното обучение и каква е тяхната роля?
- Как бихте описали разликата между дискриминативни и генеративни модели?
- Какви приложения на изкуствения интелект изискват създаване на нови данни, а не само класификация или регресия?

## 2. Overview
Generative Adversarial Networks (GANs) са клас невронни мрежи, които се използват за генериране на нови, реалистични данни, като изображения, аудио или текст. Те се състоят от две състезаващи се мрежи: генератор и дискриминатор. Генераторът се опитва да създаде фалшиви данни, които да изглеждат като истински, докато дискриминаторът се опитва да различи истинските от фалшивите.

Тази динамика на състезание води до подобряване на качеството на генерираните данни с времето. GANs намират приложение в множество области като създаване на изкуствено изкуство, подобряване на резолюцията на изображения, симулации и дори в медицината за генериране на синтетични данни.

Разбирането на GANs е ключово за всеки, който иска да работи с генеративни модели и да създава системи, които могат да учат от данни и да създават нови, иновативни решения.

## 3. Key Concepts
- **Generator (Генератор)** – невронна мрежа, която създава нови данни от случайни шумове. Може да се представи като художник, който рисува картина от въображението си.
- **Discriminator (Дискриминатор)** – невронна мрежа, която оценява дали даден вход е истински или генериран. Той е като критик, който преценява автентичността на картината.
- **Adversarial Training (Състезателно обучение)** – процесът, при който генераторът и дискриминаторът се обучават едновременно, като се опитват да надхитрят един друг.
- **Latent Space (Латентно пространство)** – многомерно пространство, от което генераторът взима входни данни (шум), за да създаде нови примери.
- **Mode Collapse (Колапс на модове)** – проблем, при който генераторът създава ограничен набор от много сходни примери, губейки разнообразие.
- **Loss Functions (Функции на загуба)** – математически функции, които измерват колко добре генераторът и дискриминаторът изпълняват задачите си.

## 4. Step-by-step Learning Path
1. **Запознайте се с основите на невронните мрежи и оптимизацията**
   - Фокус: Разберете как работят невронните мрежи и как се оптимизират.
   - Задача: Имплементирайте проста feedforward мрежа за класификация.
   - Въпроси: Какво е backpropagation? Как се изчислява грешката?

2. **Разберете архитектурата на GAN**
   - Фокус: Изучете ролята на генератора и дискриминатора.
   - Задача: Нарисувайте блок-схема на GAN и опишете потока на данни.
   - Въпроси: Какво е целта на генератора? Какво прави дискриминаторът?

3. **Имплементирайте базов GAN за генериране на изображения**
   - Фокус: Практическа реализация с TensorFlow или PyTorch.
   - Задача: Създайте GAN, който генерира изображения на ръкописни цифри (MNIST).
   - Въпроси: Как се обновяват параметрите на генератора и дискриминатора? Какво означава "adversarial loss"?

4. **Анализирайте и подобрете резултатите**
   - Фокус: Разберете проблемите като mode collapse и нестабилно обучение.
   - Задача: Внедрете техники като batch normalization или различни loss функции.
   - Въпроси: Какво е mode collapse? Как може да се стабилизира обучението?

5. **Изследвайте разширени архитектури и приложения**
   - Фокус: Разгледайте DCGAN, Conditional GAN, StyleGAN.
   - Задача: Изберете една разширена архитектура и я имплементирайте.
   - Въпроси: Какво е условно генериране? Как StyleGAN контролира стилове?

## 5. Examples
### Пример 1: Базов GAN с PyTorch за MNIST
```python
import torch
import torch.nn as nn

class Generator(nn.Module):
    def __init__(self):
        super().__init__()
        self.model = nn.Sequential(
            nn.Linear(100, 256),
            nn.ReLU(True),
            nn.Linear(256, 784),
            nn.Tanh()
        )
    def forward(self, z):
        return self.model(z)

class Discriminator(nn.Module):
    def __init__(self):
        super().__init__()
        self.model = nn.Sequential(
            nn.Linear(784, 256),
            nn.LeakyReLU(0.2, inplace=True),
            nn.Linear(256, 1),
            nn.Sigmoid()
        )
    def forward(self, x):
        return self.model(x)
```

### Пример 2: Приложение на GAN за подобряване на резолюцията (Super-Resolution)
- GAN се използва за преобразуване на нискокачествени изображения в по-висококачествени, като се научава да добавя детайли.

### Пример 3: Conditional GAN за генериране на изображения с етикети
- Генераторът получава допълнителна информация (категория), за да създаде специфичен тип изображение, например цифра „3“ от MNIST.

## 6. Common Pitfalls
- **Нестабилно обучение** – GAN обучението често се колебае и не конвергира; използвайте техники като learning rate decay и batch normalization.
- **Mode Collapse** – генераторът създава ограничен набор от примери; решава се чрез добавяне на шум, разнообразие в архитектурата или по-сложни loss функции.
- **Прекалено силен дискриминатор** – ако дискриминаторът е твърде добър, генераторът не се учи; балансирайте обучението им.
- **Липса на оценка на качеството** – трудно е да се измери качеството на генерираните данни; използвайте метрики като Inception Score или FID.
- **Недостатъчно данни за обучение** – GAN-овете изискват големи набори от данни за стабилно обучение.

## 7. Short Retrieval Quiz
1. Каква е ролята на генератора в GAN?
2. Какво представлява дискриминаторът?
3. Какво е mode collapse и защо е проблем?
4. Какво означава adversarial training?
5. Коя функция на загуба се използва за обучение на дискриминатора?
6. Какво е latent space в контекста на GAN?
7. Как може да се подобри стабилността на обучението на GAN?

## 8. Quick Recap
- GANs са генеративни модели с две състезаващи се мрежи: генератор и дискриминатор.
- Генераторът създава фалшиви данни, а дискриминаторът ги оценява.
- Обучението е състезателно и води до подобряване на качеството на генерираните данни.
- Основни проблеми включват нестабилно обучение и mode collapse.
- Разширени архитектури като DCGAN и Conditional GAN подобряват възможностите на базовия модел.
- Практическата реализация изисква баланс и внимателен дизайн на мрежите и функциите на загуба.
- GANs имат широк спектър от приложения в изкуството, медицината и индустрията.

## 9. Spaced Review Plan

| Време след изучаване | Промпт за преговор                                  |
|----------------------|----------------------------------------------------|
| 1 ден                | Обяснете ролята на генератора и дискриминатора.   |
| 3 дни                | Какво е mode collapse и как се предотвратява?     |
| 1 седмица            | Опишете процеса на adversarial training.           |
| 1 месец              | Прегледайте основните архитектури и приложения на GANs. |