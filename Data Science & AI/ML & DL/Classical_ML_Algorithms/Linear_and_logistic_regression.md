# Linear_and_logistic_regression

## 1. Activate Prior Knowledge

- Какво представляват зависимите и независимите променливи в контекста на моделирането на данни?
- Как бихте използвали математически модел, за да предскажете стойност или категория на база исторически данни?
- Къде в софтуерните системи или AI приложения бихте срещнали нужда от прогнозиране на числови стойности или класификация?

## 2. Overview

Линейната и логистичната регресия са фундаментални статистически методи, широко използвани в машинното обучение и анализа на данни. Те служат за моделиране на връзката между една или повече независими променливи (фактори) и зависима променлива, която може да бъде числова (линейна регресия) или категориална (логистична регресия).

Линейната регресия се използва за предсказване на непрекъснати стойности, например прогнозиране на цени, температури или времеви серии. Тя намира най-добрата права линия (или хиперплан) в многомерното пространство, която минимизира разликата между предсказаните и реалните стойности.

Логистичната регресия, от своя страна, е метод за класификация, който оценява вероятността даден пример да принадлежи към определена категория (например болен/здрав, спам/не-спам). Тя използва логистичната функция (сигмоид) за преобразуване на линейна комбинация от входните променливи в вероятност.

И двата метода са основа за по-сложни модели и често се използват като първа стъпка в анализа, тъй като са лесни за интерпретиране и ефективни при много практически задачи.

## 3. Key Concepts

- **Dependent Variable (Зависима променлива)** – Стойността, която се опитваме да предскажем или обясним с модела. Например, цената на жилище.
- **Independent Variables (Независими променливи)** – Фактори или характеристики, които влияят върху зависимата променлива. Например, квадратура, локация.
- **Linear Regression (Линейна регресия)** – Модел, който описва линейна връзка между независимите променливи и зависимата променлива. Мислете за това като за намиране на най-добрата права линия, която минава през точките.
- **Logistic Regression (Логистична регресия)** – Модел за класификация, който използва логистична функция, за да предскаже вероятността за принадлежност към клас. Аналогия: превръщане на линейна стойност в вероятност чрез „превключвател“.
- **Cost Function (Функция на разходите)** – Мярка за грешката на модела, която трябва да се минимизира. Например, средноквадратична грешка при линейна регресия.
- **Gradient Descent (Градиентен спуск)** – Итеративен алгоритъм за оптимизация, който намира параметрите на модела, минимизирайки функцията на разходите.
- **Sigmoid Function (Сигмоидна функция)** – Функция, която преобразува всяко реално число в стойност между 0 и 1, използвана в логистичната регресия за моделиране на вероятности.

## 4. Step-by-step Learning Path

1. **Разбиране на основите на линейната регресия**  
   - Фокус: Формулата на линейната регресия и интерпретация на коефициентите.  
   - Задача: Използвайте Excel или Python (numpy) за изчисляване на линейна регресия върху малък набор от данни.  
   - Въпроси: Какво означава наклонът на правата? Какво е ролята на свободния член?

2. **Изучаване на функцията на разходите и градиентния спуск**  
   - Фокус: Как се измерва грешката и как се оптимизират параметрите.  
   - Задача: Имплементирайте градиентен спуск за минимизиране на средноквадратичната грешка в Python.  
   - Въпроси: Защо не можем просто да изберем произволни коефициенти? Какво прави градиентният спуск?

3. **Въвеждане в логистичната регресия**  
   - Фокус: Разликата между линейна и логистична регресия, логистична функция.  
   - Задача: Използвайте sklearn за обучение на логистичен регресионен модел върху бинарен набор от данни (например, предсказване на болест).  
   - Въпроси: Какво означава изходът на логистичната регресия? Как се интерпретира вероятността?

4. **Оценка на моделите и метрики**  
   - Фокус: Метрики за качество – R², средна квадратична грешка, точност, F1-score.  
   - Задача: Изчислете и сравнете метриките за линейна и логистична регресия на реални данни.  
   - Въпроси: Кога R² е подходяща метрика? Какво показва F1-score?

5. **Практическо приложение и интерпретация**  
   - Фокус: Как да използваме моделите за вземане на решения и как да интерпретираме резултатите.  
   - Задача: Анализирайте резултатите от обучен модел и съставете доклад с препоръки.  
   - Въпроси: Какво означава статистическата значимост на коефициентите? Как да избегнем overfitting?

## 5. Examples

### Пример 1: Линейна регресия с Python

```python
import numpy as np
from sklearn.linear_model import LinearRegression

# Данни: квадратура (кв.м) и цена (хиляди лева)
X = np.array([[50], [60], [70], [80], [90]])
y = np.array([150, 180, 210, 240, 270])

model = LinearRegression()
model.fit(X, y)

print(f"Наклон: {model.coef_[0]:.2f}, Свободен член: {model.intercept_:.2f}")
# Прогноза за 75 кв.м
print(f"Прогноза: {model.predict([[75]])[0]:.2f} хиляди лева")
```

### Пример 2: Логистична регресия за класификация

```python
from sklearn.linear_model import LogisticRegression
from sklearn.datasets import load_breast_cancer
from sklearn.model_selection import train_test_split
from sklearn.metrics import accuracy_score

data = load_breast_cancer()
X_train, X_test, y_train, y_test = train_test_split(data.data, data.target, test_size=0.3, random_state=42)

model = LogisticRegression(max_iter=1000)
model.fit(X_train, y_train)

y_pred = model.predict(X_test)
print(f"Точност: {accuracy_score(y_test, y_pred):.2f}")
```

### Пример 3: Визуализация на сигмоидната функция

```python
import numpy as np
import matplotlib.pyplot as plt

def sigmoid(x):
    return 1 / (1 + np.exp(-x))

x = np.linspace(-10, 10, 100)
y = sigmoid(x)

plt.plot(x, y)
plt.title("Sigmoid Function")
plt.xlabel("x")
plt.ylabel("sigmoid(x)")
plt.grid(True)
plt.show()
```

## 6. Common Pitfalls

- **Пренебрегване на предпоставките на линейната регресия** – Например, хомоскедастичност и нормалност на грешките. Решение: анализирайте остатъците и използвайте трансформации при нужда.
- **Използване на линейна регресия за класификационни задачи** – Това води до нелогични прогнози (например отрицателни вероятности). Използвайте логистична регресия вместо това.
- **Overfitting при малки набори от данни** – Моделът се адаптира прекалено към тренировъчните данни и не обобщава добре. Решение: използвайте регуляризация и крос-валидация.
- **Неправилна интерпретация на коефициентите в логистичната регресия** – Те не са директни промени в вероятността, а в логаритмичния шанс (log-odds).
- **Игнориране на мултиколинеарност** – Силно корелирани независими променливи могат да изкривят оценките. Решение: премахнете или комбинирайте променливите.

## 7. Short Retrieval Quiz

1. Каква е основната разлика между линейна и логистична регресия?
2. Какво представлява функцията на разходите при линейна регресия?
3. За какво служи сигмоидната функция в логистичната регресия?
4. Какво означава наклонът на правата в линейната регресия?
5. Кога е подходящо да използваме логистична регресия?
6. Какво е градиентен спуск?
7. Какво е overfitting и как може да се предотврати?

## 8. Quick Recap

- Линейната регресия предсказва числови стойности чрез линейна комбинация на входните променливи.
- Логистичната регресия е за бинарна класификация и използва сигмоидната функция за моделиране на вероятности.
- Функцията на разходите измерва грешката на модела и се минимизира чрез оптимизационни алгоритми като градиентен спуск.
- Правилната интерпретация на параметрите и предпоставките на моделите е ключова за надеждни изводи.
- Използването на подходящи метрики и техники за предотвратяване на overfitting подобрява качеството на модела.
- Практическото приложение изисква разбиране както на математическата основа, така и на софтуерната имплементация.

## 9. Spaced Review Plan

| Време след изучаване | Промпт за преговор                                      |
|----------------------|---------------------------------------------------------|
| 1 ден                | Обяснете разликата между линейна и логистична регресия. |
| 3 дни                | Опишете как работи градиентният спуск.                  |
| 1 седмица            | Дайте пример за приложение на логистична регресия.      |
| 1 месец              | Как бихте открили и предотвратили overfitting?          |